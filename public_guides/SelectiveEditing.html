
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Selective Editing in Python &#8212; SML Public Methods</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'public_guides/SelectiveEditing';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Thousand Pound Correction in Python" href="ThousandPoundCorrection.html" />
    <link rel="prev" title="Date Adjustment in Python" href="DateAdjustment.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="SML Public Methods - Home"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="SML Public Methods - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    SML User Guides
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="CellKeyPerturbation_Py.html">Cell Key Perturbation in Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="DateAdjustment.html">Date Adjustment in Python</a></li>




<li class="toctree-l1 current active"><a class="current reference internal" href="#">Selective Editing in Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="ThousandPoundCorrection.html">Thousand Pound Correction in Python</a></li>




<li class="toctree-l1"><a class="reference internal" href="TotalsAndComponents.html">Totals and Components in Python</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Accessibility</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../AccessibilityStatement.html">Accessibility Statement</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ONSDigital/sml-jbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ONSDigital/sml-jbook/issues/new?title=Issue%20on%20page%20%2Fpublic_guides/SelectiveEditing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/public_guides/SelectiveEditing.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Selective Editing in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Selective Editing in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sml-user-guide">SML User Guide</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#user-notes">User Notes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-and-installing-the-method">Finding and Installing the method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements-and-dependencies">Requirements and Dependencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-validity">Assumptions and Validity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-the-method">How to Use the Method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-input">Method Input</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-output">Method Output</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-synthetic-data">Example (Synthetic) Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#worked-example">Worked Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-of-special-cases">Treatment of Special Cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-process-flow-formal-definition">Statistical Process Flow / Formal Definition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-vailidity">Assumptions &amp; Vailidity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-information">Additional Information</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="selective-editing-in-python">
<h1>Selective Editing in Python<a class="headerlink" href="#selective-editing-in-python" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="sml-user-guide">
<h1>SML User Guide<a class="headerlink" href="#sml-user-guide" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Descriptive</p></th>
<th class="head text-left"><p>Details</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Support Area</p></td>
<td class="text-left"><p>Methodology - Editing &amp; Imputation</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Method Theme</p></td>
<td class="text-left"><p>Editing</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Status</p></td>
<td class="text-left"><p>Ready to Use</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Inputs</p></td>
<td class="text-left"><p>Reference, question list, adjusted return, predicted value, auxillary predicted value, standardising factor, design weight, threshold</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Outputs</p></td>
<td class="text-left"><p>Reference, Score1, ScoreM, Final_Score, Selective Editing Marker, Predicted Marker</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Method Version</p></td>
<td class="text-left"><p>1.2.5</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Code Repository</p></td>
<td class="text-left"><p><a class="github reference external" href="https://github.com/ONSdigital/sml-python-small/blob/main/sml_small/selective_editing.py">ONSdigital/sml-python-small</a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>Selective Editing is an internationally recognised editing method where potential errors are prioritised according to their expected impact on key outputs.
Selective Editing assigns a score to specified variables where the score reflects the impact that editing the respondent will have on the estimates.
Contributors with a score above a predetermined threshold are flagged for manual review to be validated, while contributors with a score below the threshold pass through unchecked.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="user-notes">
<h1>User Notes<a class="headerlink" href="#user-notes" title="Link to this heading">#</a></h1>
<section id="finding-and-installing-the-method">
<h2>Finding and Installing the method<a class="headerlink" href="#finding-and-installing-the-method" title="Link to this heading">#</a></h2>
<p><strong>This method requires Python &gt;=3.7.1, &lt;4.0.0 and uses the Pandas package &gt;=1.3.5, &lt;=v1.5.3.</strong></p>
<p>If you are using Pandas &gt;=2.0 this will be uninstalled and v1.5.3 installed.</p>
<blockquote>
<div><p><sub>To prevent downgrading software on your system, we recommend creating a virtual environment to install and run SML methods. This will enable you to install the method with the required version of Python, etc, without disrupting the newer versions you may be running on your system. If you’re new to virtual environments, please see our guidence on installing a method in the Help centre of our SML website to get started. Otherwise, use your preferred method to create a virtual environment with the correct software versions.</sub></p>
</div></blockquote>
<p>The method package can be installed from Artifactory/PyPI using the following code in the terminal or command prompt:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">sml_small</span> 
</pre></div>
</div>
<p>In your code you can import the method using:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sml_small.selective_editing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">seled</span>
</pre></div>
</div>
</section>
<section id="requirements-and-dependencies">
<h2>Requirements and Dependencies<a class="headerlink" href="#requirements-and-dependencies" title="Link to this heading">#</a></h2>
<p>This method requires input data supplied as a Pandas dataframe.</p>
</section>
<section id="assumptions-and-validity">
<h2>Assumptions and Validity<a class="headerlink" href="#assumptions-and-validity" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The method will automatically assign adjusted return (ar), predicted value (pv), auxiliary predicted
value (apv) and standardising factor (sf) based on the column names of the inputs.</p></li>
<li><p>Unless otherwise noted, fields must not contain Null values.</p></li>
<li><p>If the “weighted mean score” is selected to combine score, then the
sum of the weights provided should total to 1.</p></li>
</ul>
</section>
<section id="how-to-use-the-method">
<h2>How to Use the Method<a class="headerlink" href="#how-to-use-the-method" title="Link to this heading">#</a></h2>
<p>Once the selective editing method is available on your computer you will be
able to call the method and perform selective editing on a dataset.</p>
<p>The input dataset will need to contain a specific suffix structure for each question used in
calculating the score. The adjusted return value will have ‘_ar’, the
predicted value will have ‘_pv’, the auxiliary predicted value will
have ‘_apv’, the standardising factor will have ‘_sf’ and the weight
(if weighted scores are chosen) will have ‘_wt’, where the sum of ‘_wt’
has to add up to 1.</p>
<section id="method-input">
<h3>Method Input<a class="headerlink" href="#method-input" title="Link to this heading">#</a></h3>
<p>Input records must include the following fields of the
correct types:</p>
<ul class="simple">
<li><p>reference (any type): Unique to each respondent.</p></li>
<li><p>design_weight (numeric): Also known as the a-weight.</p></li>
<li><p>threshold (numeric): The selective editing threshold. This is unique for
each domain and is specified by Methodology.</p></li>
<li><p>question_1_ar (numeric): This is the adjusted return for question 1. The adjusted
return has usually been through other editing strategies before Selective
Editing.</p></li>
<li><p>question_1_pv (numeric): This is the predicted value for question 1, usually the
respondent’s value from the previous period.</p></li>
<li><p>question_1_apv (numeric): This is the auxiliary predicted variable used when
there is not a previous period value available.</p></li>
<li><p>question_1_sf (numeric): This is the standardising factor, which is the weighted
domain estimate for the previous period.</p></li>
<li><p>question_1_wt (numeric): This column is a weight column, which is used when the
weighted option is used as the combination method.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Reference</p></th>
<th class="head"><p>design_weight</p></th>
<th class="head"><p>threshold</p></th>
<th class="head"><p>question_1_ar</p></th>
<th class="head"><p>question_1_pv</p></th>
<th class="head"><p>question_1_apv</p></th>
<th class="head"><p>question_1_sf</p></th>
<th class="head"><p>question_1_wt</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>49900001</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>800</p></td>
<td><p></p></td>
<td><p>424</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>49900002</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>656</p></td>
<td><p>390</p></td>
<td><p>259</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>49900003</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>997</p></td>
<td><p>773</p></td>
<td><p>912</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>49900004</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>676</p></td>
<td><p></p></td>
<td><p>334</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>49900005</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>632</p></td>
<td><p>871</p></td>
<td><p>684</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>49900006</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>985</p></td>
<td><p>345</p></td>
<td><p>312</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>49900007</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>468</p></td>
<td><p>963</p></td>
<td><p>773</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>49900008</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>772</p></td>
<td><p>733</p></td>
<td><p>833</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>49900009</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>621</p></td>
<td><p>673</p></td>
<td><p>898</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>49900010</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>736</p></td>
<td><p>377</p></td>
<td><p>646</p></td>
<td><p>800000</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="method-output">
<h3>Method Output<a class="headerlink" href="#method-output" title="Link to this heading">#</a></h3>
<p>Output records will contain the following new fields:</p>
<ul class="simple">
<li><p>question_1_s: This is the score for question 1.</p></li>
<li><p>question_1_pm: This is a predicted marker, which indicates whether the predicted value (True) or
the auxiliary value (False) has been used.</p></li>
<li><p>Final_score: The score after a combination method is applied to multiple variables (if used). This
is the value that is compared to the threshold.</p></li>
<li><p>Selective_edting_marker: If the respondent needs to be contacted for validation, the marker will be False (i.e., the score
is &gt;= the threshold value). If the respondent does not need to be contacted, the marker will be True.</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Reference</p></th>
<th class="head"><p>design_weight</p></th>
<th class="head"><p>threshold</p></th>
<th class="head"><p>question_1_ar</p></th>
<th class="head"><p>question_1_pv</p></th>
<th class="head"><p>question_1_apv</p></th>
<th class="head"><p>question_1_sf</p></th>
<th class="head"><p>question_1_s</p></th>
<th class="head"><p>question_1_pm</p></th>
<th class="head"><p>final_score</p></th>
<th class="head"><p>selective_editing_marker</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>49900001</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>800</p></td>
<td><p></p></td>
<td><p>424</p></td>
<td><p>800000</p></td>
<td><p>0.94</p></td>
<td><p>FALSE</p></td>
<td><p>0.94</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>49900002</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>656</p></td>
<td><p>390</p></td>
<td><p>259</p></td>
<td><p>800000</p></td>
<td><p>0.665</p></td>
<td><p>TRUE</p></td>
<td><p>0.665</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>49900003</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>997</p></td>
<td><p>773</p></td>
<td><p>912</p></td>
<td><p>800000</p></td>
<td><p>0.56</p></td>
<td><p>TRUE</p></td>
<td><p>0.56</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-odd"><td><p>49900004</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>676</p></td>
<td><p></p></td>
<td><p>334</p></td>
<td><p>800000</p></td>
<td><p>0.855</p></td>
<td><p>FALSE</p></td>
<td><p>0.855</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>49900005</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>632</p></td>
<td><p>871</p></td>
<td><p>684</p></td>
<td><p>800000</p></td>
<td><p>0.5975</p></td>
<td><p>TRUE</p></td>
<td><p>0.5975</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-odd"><td><p>49900006</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>985</p></td>
<td><p>345</p></td>
<td><p>312</p></td>
<td><p>800000</p></td>
<td><p>1.6</p></td>
<td><p>TRUE</p></td>
<td><p>1.6</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td><p>49900007</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>468</p></td>
<td><p>963</p></td>
<td><p>773</p></td>
<td><p>800000</p></td>
<td><p>1.2375</p></td>
<td><p>TRUE</p></td>
<td><p>1.2375</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td><p>49900008</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>772</p></td>
<td><p>733</p></td>
<td><p>833</p></td>
<td><p>800000</p></td>
<td><p>0.0975</p></td>
<td><p>TRUE</p></td>
<td><p>0.0975</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-even"><td><p>49900009</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>621</p></td>
<td><p>673</p></td>
<td><p>898</p></td>
<td><p>800000</p></td>
<td><p>0.13</p></td>
<td><p>TRUE</p></td>
<td><p>0.13</p></td>
<td><p>TRUE</p></td>
</tr>
<tr class="row-odd"><td><p>49900010</p></td>
<td><p>20</p></td>
<td><p>0.6</p></td>
<td><p>736</p></td>
<td><p>377</p></td>
<td><p>646</p></td>
<td><p>800000</p></td>
<td><p>0.8975</p></td>
<td><p>TRUE</p></td>
<td><p>0.8975</p></td>
<td><p>FALSE</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that in this example, References 49900001 and 49900004 do not have predicted values available for the
score calculation. You can see the blank cells for the predicted values and question_1_pm is False.  This shows that the auxillary value is used for these respondents. The rest of the respondents have the predicted value
available and therefore, question_1_pm is True.</p>
</section>
</section>
<section id="example-synthetic-data">
<h2>Example (Synthetic) Data<a class="headerlink" href="#example-synthetic-data" title="Link to this heading">#</a></h2>
<p>Files containing the example input and output data given above can be found in the <a class="reference external" href="https://github.com/ONSdigital/sml-public/tree/main/example_data/SelectiveEditing">example_data</a> of this repository.</p>
<p>Input data:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>selective_editing_input_data_example_1.csv
</pre></div>
</div>
<p>Expected output after running the worked example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>selective_editing_output_data_example_1.csv
</pre></div>
</div>
</section>
<section id="worked-example">
<h2>Worked Example<a class="headerlink" href="#worked-example" title="Link to this heading">#</a></h2>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sml_small.selective_editing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">seled</span>

<span class="c1"># Location of csv file</span>
<span class="n">datafile</span> <span class="o">=</span> <span class="s2">&quot;selective_editing_input_data_example_1.csv&quot;</span>

<span class="c1"># Read in csv file above</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">datafile</span><span class="p">)</span>

<span class="c1"># Call the Selective Editing method</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">seled</span><span class="o">.</span><span class="n">selective_editing</span><span class="p">(</span><span class="n">input_dataframe</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="c1"># DataFrame of the test data (above)</span>
                                 <span class="n">reference_col</span> <span class="o">=</span> <span class="s1">&#39;reference&#39;</span><span class="p">,</span> <span class="c1"># Reference column</span>
                                 <span class="n">design_weight_col</span> <span class="o">=</span> <span class="s1">&#39;design_weight&#39;</span><span class="p">,</span> <span class="c1"># Design weight column</span>
                                 <span class="n">threshold_col</span> <span class="o">=</span> <span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="c1"># Threshold column</span>
                                 <span class="n">question_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;question_1&#39;</span><span class="p">],</span> <span class="c1"># Question(s) we are performing Selective Editing on</span>
                                 <span class="n">combination_method</span> <span class="o">=</span> <span class="s1">&#39;maximum&#39;</span><span class="p">,</span> <span class="c1"># Type combination, will accept &#39;maximum&#39;, &#39;mean&#39;, &#39;weighted&#39;, &#39;minkowski&#39;, default = maximum</span>
                                 <span class="n">minkowski_distance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Set to 0 if minkowski is not selected. Set to value of p if minkowski is selected above. </span>
                                 <span class="n">show_sums</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Provides additional data on score calculations</span>
                                 
<span class="n">output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;selective_editing_output_data_example_1.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The output gets exported as a .csv file, which will be saved in your working directory.</p>
<section id="treatment-of-special-cases">
<h3>Treatment of Special Cases<a class="headerlink" href="#treatment-of-special-cases" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fields should not contain Null values</p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="methodology">
<h1>Methodology<a class="headerlink" href="#methodology" title="Link to this heading">#</a></h1>
<section id="terminology">
<h2>Terminology<a class="headerlink" href="#terminology" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Contributor reference - Unique identifier assigned to each respondent.</p></li>
<li><p>Adjusted return - The most recent unedited returned data
value (for a given variable) in the current period, t.</p></li>
<li><p>Predicted value - The first predictor value (for a given
variable) for the current period adjusted return.</p></li>
<li><p>Auxiliary predicted value - This is the secondary
predictor (for a given variable) for the current
period adjusted return.</p></li>
<li><p>Standardising factor - The domain group estimate used to
standardise scores within a given domain group.</p></li>
<li><p>Design weight - An a-weight, generated by another
method.</p></li>
<li><p>Selective Editing domain group - Indicates which Selective
Editing domain group a given respondent belongs to.</p></li>
<li><p>Selective Editing threshold - Unique threshold for each domain group
against which the selected editing score is compared.</p></li>
<li><p>Combining function - If the method is applied to more than
one variable, then the scores can be combined in the
following ways: Average, Sum, Max, Weighted mean, Minkowski.</p></li>
</ul>
</section>
<section id="statistical-process-flow-formal-definition">
<h2>Statistical Process Flow / Formal Definition<a class="headerlink" href="#statistical-process-flow-formal-definition" title="Link to this heading">#</a></h2>
<p>A selective editing score is calculated for each reporting unit i in
time t. The selective editing score is calculated by multiplying the
design weight by the modulus of the adjusted return for reporting unit
i at time t by the predicted value for reporting unit i at time t,
divided by the standardising factor, and all multiplied by 100 as shown
by the equation below.</p>
<div class="highlight-asciimath notranslate"><div class="highlight"><pre><span></span>Score = 100*{{a-weight*|current value-predicted value|}/Standardising factor}
</pre></div>
</div>
<p>The predicted value is a clean response (i.e. free from
error adjusted return) for reporting unit i at time t-1. However, if
a clean response for reporting unit i at time t-1 is not available
then imputed or constructed previous period data is used. If this
value isn’t available, then the auxiliary predicted value for reporting
unit i at time t is used.</p>
<p>The standardising factor is the weighted domain estimate for a given
variable at time t-1, which is used to determine a
respondent’s potential impact on key output estimates.</p>
<p><strong>Combining Scores</strong></p>
<p>If selective editing is applied to more than one variable, then a final score is calculated using
one of the following combination methods:</p>
<ul class="simple">
<li><p>Maximum score: The maximum score of all the variables.</p></li>
<li><p>Weighted mean score: Where each score is multiplied by a weight, where
all weights will add up to 1.</p></li>
<li><p>Mean score: Where all scores are added up and divided by the number of
scores.</p></li>
<li><p>Minkowski distance: Each variable’s score is multiplied to the power of p. All the scores are then summed and multiplied to the
power of 1/p, where p &gt;= 1 and is an integer.</p></li>
</ul>
<p><strong>Generate selective editing marker</strong></p>
<p>Each final score is compared to the threshold associated with
the respondent’s domain group.</p>
<p>If the final score is greater than or equal to the selective editing
threshold, then the selective editing marker for the reporting
unit is marked False and the respondent requires
validation.</p>
<p>If the final score is less than the selective editing threshold, the selective editing marker for
the reporting unit is marked True and the respondent does not require validation.</p>
<section id="assumptions-vailidity">
<h3>Assumptions &amp; Vailidity<a class="headerlink" href="#assumptions-vailidity" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>All data inputs required by the method are available and are on a
standardised basis.</p></li>
<li><p>The predicted variable and auxiliary predicted value should both
be good predictors of the returned data for time t.</p></li>
<li><p>The predicted value in the score calculation must have been cleaned
and free from errors. This is not limited to genuine returns, and
it may be an imputed or constructed value if a clean response is
not available.</p></li>
<li><p>Each respondent is clearly classified into one mutually exclusive
domain group.</p></li>
<li><p>The thresholds specified are valid and appropriate (&gt;0)</p></li>
</ul>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="additional-information">
<h1>Additional Information<a class="headerlink" href="#additional-information" title="Link to this heading">#</a></h1>
<p>The ONS Statistical Methods Library at <a class="reference external" href="https://statisticalmethodslibrary.ons.gov.uk/">https://statisticalmethodslibrary.ons.gov.uk/</a>
contains:</p>
<ul class="simple">
<li><p>Further information about the methods including a link to the GitHub repository which contains detailed API information as part of the method code.</p></li>
<li><p>Information about other methods available through the library.</p></li>
</ul>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading">#</a></h2>
<p>Unless stated otherwise, the SML codebase is released under the MIT License. This covers both the codebase and any sample code in the documentation.</p>
<p>The documentation is available under the terms of the Open Government 3.0 license.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./public_guides"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="DateAdjustment.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Date Adjustment in Python</p>
      </div>
    </a>
    <a class="right-next"
       href="ThousandPoundCorrection.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Thousand Pound Correction in Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Selective Editing in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sml-user-guide">SML User Guide</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#user-notes">User Notes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-and-installing-the-method">Finding and Installing the method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements-and-dependencies">Requirements and Dependencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-validity">Assumptions and Validity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use-the-method">How to Use the Method</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-input">Method Input</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#method-output">Method Output</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-synthetic-data">Example (Synthetic) Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#worked-example">Worked Example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-of-special-cases">Treatment of Special Cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#methodology">Methodology</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-process-flow-formal-definition">Statistical Process Flow / Formal Definition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-vailidity">Assumptions &amp; Vailidity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-information">Additional Information</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#license">License</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ONS Statistical Methods Library
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>